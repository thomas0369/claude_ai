#!/usr/bin/env python3
"""
Test 16-Asset Configuration
Verify all assets load correctly and test data provider routing
"""

import sys
sys.path.insert(0, 'src')

from config import ALL_ASSETS, FOREX_PAIRS, COMMODITIES, INDICES, STOCKS, CRYPTO

print("=" * 60)
print("16-ASSET PORTFOLIO CONFIGURATION TEST")
print("=" * 60)

print(f"\nğŸ“Š Asset Count Summary:")
print(f"  Total Assets: {len(ALL_ASSETS)}")
print(f"  â”œâ”€ Forex Pairs: {len(FOREX_PAIRS)}")
print(f"  â”œâ”€ Commodities: {len(COMMODITIES)}")
print(f"  â”œâ”€ Indices: {len(INDICES)}")
print(f"  â”œâ”€ Stocks: {len(STOCKS)}")
print(f"  â””â”€ Crypto: {len(CRYPTO)}")

print(f"\nğŸ“‹ Complete Asset List ({len(ALL_ASSETS)} assets):")
print()

asset_num = 1
print("ğŸ† FOREX MAJORS:")
for asset in FOREX_PAIRS:
    print(f"  {asset_num:2d}. {asset}")
    asset_num += 1

print("\nğŸ’ COMMODITIES:")
for asset in COMMODITIES:
    print(f"  {asset_num:2d}. {asset}")
    asset_num += 1

print("\nğŸ“ˆ INDICES:")
for asset in INDICES:
    print(f"  {asset_num:2d}. {asset}")
    asset_num += 1

print("\nğŸ’¼ STOCKS:")
for asset in STOCKS:
    print(f"  {asset_num:2d}. {asset}")
    asset_num += 1

print("\nâ‚¿ CRYPTO:")
for asset in CRYPTO:
    print(f"  {asset_num:2d}. {asset}")
    asset_num += 1

# Test data provider routing
print("\n" + "=" * 60)
print("DATA PROVIDER ROUTING TEST")
print("=" * 60)

try:
    from dual_provider_manager import DualProviderManager

    manager = DualProviderManager()

    print("\nğŸ“Š Provider Assignment:")

    twelvedata_assets = []
    massive_assets = []

    for asset in ALL_ASSETS:
        # Determine which provider will be used (based on routing logic)
        if asset in FOREX_PAIRS or asset in ["XAU/USD", "USOIL"]:
            twelvedata_assets.append(asset)
        else:
            massive_assets.append(asset)

    print(f"\nğŸ“Š TwelveData ({len(twelvedata_assets)} assets):")
    for asset in twelvedata_assets:
        print(f"  â€¢ {asset}")

    print(f"\nğŸš€ Massive.com ({len(massive_assets)} assets):")
    for asset in massive_assets:
        print(f"  â€¢ {asset}")

    # Test provider support for each asset
    print("\n" + "=" * 60)
    print("PROVIDER SUPPORT VERIFICATION")
    print("=" * 60)

    from massive_provider import MassiveProvider
    from twelvedata_provider import TwelveDataProvider

    massive = MassiveProvider()
    twelve = TwelveDataProvider()

    print("\nâœ“ Symbol Support Check:")
    for asset in ALL_ASSETS:
        massive_support = massive.supports_symbol(asset)
        twelve_support = twelve.supports_symbol(asset)

        if massive_support and twelve_support:
            status = "âœ“ BOTH"
        elif massive_support:
            status = "âœ“ Massive.com"
        elif twelve_support:
            status = "âœ“ TwelveData"
        else:
            status = "âœ— NONE"

        print(f"  {asset:12s} â†’ {status}")

    print("\n" + "=" * 60)
    print("âœ… CONFIGURATION TEST COMPLETE")
    print("=" * 60)

    # API Usage Summary
    print(f"\nğŸ“Š API Usage Impact:")
    print(f"  Assets: 16")
    print(f"  Calls per scan: 16 Ã— 3 = 48 calls")
    print(f"  Daily limit: 800 calls")
    print(f"  Scans per day: 800 Ã· 48 = ~16 scans/day")
    print(f"\nâš ï¸  Reduced from 66 scans/day (4 assets) to 16 scans/day (16 assets)")
    print(f"  Trade-off: More diversification, fewer scans")

except Exception as e:
    print(f"\nâŒ Error during provider test: {e}")
    import traceback
    traceback.print_exc()

print("\n" + "=" * 60)
print("Ready to start trading with 16-asset portfolio! ğŸš€")
print("=" * 60)
