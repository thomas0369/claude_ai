'use client';

import { useEffect, useState } from 'react';

export interface GameHUDProps {
  score: number;
  targetScore: number;
  timeLimit?: number | null;
  moves?: number;
  levelNumber: number;
}

export function GameHUD({ score, targetScore, timeLimit, moves, levelNumber }: GameHUDProps) {
  const [timeRemaining, setTimeRemaining] = useState(timeLimit || 0);

  useEffect(() => {
    if (!timeLimit) return;

    setTimeRemaining(timeLimit);

    const interval = setInterval(() => {
      setTimeRemaining(prev => {
        if (prev <= 1) {
          clearInterval(interval);
          return 0;
        }
        return prev - 1;
      });
    }, 1000);

    return () => clearInterval(interval);
  }, [timeLimit]);

  const progress = Math.min((score / targetScore) * 100, 100);
  const minutes = Math.floor(timeRemaining / 60);
  const seconds = timeRemaining % 60;

  return (
    <div className="bg-white rounded-lg shadow-md p-3 md:p-6 border border-gray-200 space-y-3 md:space-y-6">
      {/* Level Info */}
      <div className="flex items-center justify-between">
        <h2 className="text-lg md:text-2xl font-bold text-gray-900">Level {levelNumber}</h2>
        {moves !== undefined && (
          <div className="text-xs md:text-sm text-gray-600">
            Moves: <span className="font-semibold text-gray-900">{moves}</span>
          </div>
        )}
      </div>

      {/* Score Display - Compact on mobile, prominent on desktop */}
      <div className="bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg px-3 py-2 md:px-8 md:py-6 border border-blue-200">
        <div className="text-center">
          <div className="text-blue-600 text-2xl md:text-5xl font-bold mb-1 md:mb-2">{score.toLocaleString()}</div>
          <div className="text-gray-600 text-xs md:text-sm font-medium tracking-wide">SCORE</div>
        </div>
      </div>

      {/* Target Score - More compact */}
      <div>
        <div className="flex items-center justify-between mb-1 md:mb-2">
          <span className="text-xs md:text-sm font-medium text-gray-600">Target</span>
          <span className="text-sm md:text-lg font-bold text-gray-900">
            {targetScore.toLocaleString()}
          </span>
        </div>
        {/* Progress bar */}
        <div className="w-full bg-gray-200 rounded-full h-2 md:h-3 overflow-hidden">
          <div
            className="bg-gradient-to-r from-blue-500 to-purple-500 h-2 md:h-3 rounded-full transition-all duration-300"
            style={{ width: `${progress}%` }}
          />
        </div>
      </div>

      {/* Timer - Smaller on mobile */}
      {timeLimit && (
        <div className="bg-gray-50 px-3 py-2 md:px-4 md:py-3 rounded-lg border border-gray-200">
          <div className="flex items-center justify-between">
            <span className="text-xs md:text-sm font-medium text-gray-600">Time</span>
            <span
              className={`text-base md:text-xl font-mono font-bold ${
                timeRemaining < 30 ? 'text-red-600' : 'text-gray-900'
              }`}
            >
              {String(minutes).padStart(2, '0')}:{String(seconds).padStart(2, '0')}
            </span>
          </div>
        </div>
      )}
    </div>
  );
}
