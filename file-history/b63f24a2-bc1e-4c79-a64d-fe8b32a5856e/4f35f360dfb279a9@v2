/**
 * ZEREZ Importer Configuration Constants
 *
 * Centralized configuration for business logic values, limits, and thresholds
 * used throughout the ZEREZ import workflow.
 */

export const ZEREZ_IMPORT_LIMITS = {
  /** Maximum products that can be imported in a single batch (to prevent timeouts) */
  MAX_PRODUCTS_PER_IMPORT: 100,

  /** Maximum results returned by GraphQL search API */
  MAX_SEARCH_RESULTS: 1000,

  /** Preview limit for faster UI response (only show first N products) */
  PREVIEW_PRODUCT_LIMIT: 20,

  /** Maximum manufacturers shown in dropdown before requiring search */
  MANUFACTURER_DROPDOWN_LIMIT: 50,

  /** Maximum errors displayed in UI before truncating */
  MAX_DISPLAYED_ERRORS: 5,
} as const;

export const DEFAULT_FILTERS = {
  /** Default power range for ZEREZ search (kW) */
  POWER_MIN: 50,
  POWER_MAX: 200,

  /** Default compliance filters */
  IS_VERIFIED: true,
  IS_4105_COMPLIANT: false,
}; // Note: No 'as const' here - these values are used as mutable state initializers

/** Sentinel value for "show all" options in select dropdowns (Radix doesn't allow empty strings) */
export const ALL_OPTIONS_SENTINEL: string = '__ALL__';

/**
 * ZEREZ directory paths relative to repository root
 * Use getZEREZPath() to get absolute paths
 */
export const ZEREZ_PATHS = {
  /** Base directory for all ZEREZ data */
  DATA_ROOT: 'data/zerez',

  /** Directory for imported JSON files from ZEREZ API */
  IMPORTS: 'data/zerez/imports',

  /** Directory for test imports (used during development/testing) */
  TEST_IMPORTS: 'data/zerez/imports/test',

  /** Directory for API export cache */
  API_EXPORTS: 'data/zerez/api_exports',
} as const;

/**
 * Get absolute path for ZEREZ directory
 *
 * @param type - Type of ZEREZ directory from ZEREZ_PATHS
 * @param repoRoot - Optional repository root (defaults to REPO_ROOT env or process.cwd()/..)
 * @returns Absolute path to the requested ZEREZ directory
 *
 * @example
 * ```ts
 * import { getZEREZPath } from '@/lib/zerez-constants';
 *
 * const importsDir = getZEREZPath('IMPORTS');
 * // Returns: /absolute/path/to/repo/data/zerez/imports
 * ```
 */
export function getZEREZPath(
  type: keyof typeof ZEREZ_PATHS,
  repoRoot?: string
): string {
  // Import path here to avoid circular dependencies
  const pathModule = require('path');
  const root = repoRoot || process.env.REPO_ROOT || pathModule.join(process.cwd(), '..');
  return pathModule.join(root, ZEREZ_PATHS[type]);
}
