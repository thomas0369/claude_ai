// Debug script to understand ZEREZ wizard flow
const { chromium } = require('playwright');

async function debugFlow() {
  const browser = await chromium.launch({ headless: false });
  const page = await browser.newContext().then(ctx => ctx.newPage());

  try {
    console.log('Step 1: Loading page...');
    await page.goto('http://localhost:3000/import/zerez');
    await page.waitForLoadState('networkidle');
    console.log('âœ“ Page loaded\n');

    console.log('Page title:', await page.title());
    console.log('\nLooking for buttons...');
    const buttons = await page.locator('button').all();
    console.log(`Found ${buttons.length} buttons\n`);

    for (let i = 0; i < Math.min(buttons.length, 10); i++) {
      const text = await buttons[i].textContent();
      console.log(`Button ${i + 1}: "${text?.trim()}"`);
    }

    console.log('\nStep 2: Clicking "Preview Products"...');
    await page.click('button:has-text("Preview Products")');
    await page.waitForTimeout(3000);

    console.log('\nAfter clicking Preview Products:');
    const newButtons = await page.locator('button').all();
    console.log(`Found ${newButtons.length} buttons\n`);

    for (let i = 0; i < Math.min(newButtons.length, 10); i++) {
      const text = await newButtons[i].textContent();
      console.log(`Button ${i + 1}: "${text?.trim()}"`);
    }

    console.log('\nLooking for sticky columns...');
    const stickyCount = await page.locator('div.sticky.left-16').count();
    console.log(`Sticky columns found: ${stickyCount}`);

    console.log('\nLooking for tables...');
    const tableCount = await page.locator('table, div[role="table"]').count();
    console.log(`Tables found: ${tableCount}`);

    console.log('\nWaiting 10 seconds for inspection...');
    await page.waitForTimeout(10000);

  } catch (error) {
    console.error('Error:', error.message);
  } finally {
    await browser.close();
  }
}

debugFlow();
