# ZEREZ Detailed Data - Implementation Status

## ‚úÖ Completed (2025-11-03)

1. **Python Script**: `zerez_fetch_detailed_units.py`
   - Fetches 75+ fields using `unit(id: UUID)` GraphQL query
   - Includes all German technical specifications

2. **API Endpoint**: `/api/zerez/fetch-detailed`
   - Next.js route for fetching detailed units
   - Batch processing up to 100 units

3. **Type System**: `lib/zerez-types.ts`
   - Extended ZEREZUnitSchema to 75+ fields
   - All power, electrical, flicker parameters included

4. **Preview Table**: `components/VirtualizedProductTable.tsx`
   - Displays 50+ columns with all detailed specs
   - German technical terms: Bemessungswirkleistung, Sto√ükurzschlussstrom, etc.

5. **Preview Flow**: `app/import/zerez/page.tsx`
   - Auto-fetches detailed data after search
   - User warning if detailed fetch fails

## ‚ö†Ô∏è Known Inconsistency

### Import vs Preview Data Mismatch

**Problem**:
- Preview shows **75+ detailed fields** (including German tech specs)
- Import saves **30 basic fields** only (missing detailed specs)

**Why This Happens**:
- Preview uses new `zerez_fetch_detailed_units.py` (detailed query)
- Import uses old `zerez_json_saver.py` (saves search results only)

**Impact**:
- Users see detailed specs in preview
- But imported JSON files lack those specs
- Inconsistent user experience

**Recommendation**:
Update import flow to also fetch and save detailed data:

```typescript
// In handleImportDetails():
// 1. After user selects products from preview
// 2. Fetch detailed data for selected products
// 3. Save detailed data instead of basic search results
```

**Alternative Approach**:
Update `zerez_json_importer.py` to use the detailed `unit(id)` query instead of `unitOverview`:

```python
# Change line 130 in zerez_json_importer.py:
# OLD: "query": GRAPHQL_QUERY  # (uses unitOverview)
# NEW: Use detailed unit query like zerez_fetch_detailed_units.py
```

## üìä Field Comparison

| Data Source | Fields | Has German Tech Specs? | Used Where |
|-------------|--------|------------------------|------------|
| `unitOverview` query | 30 | ‚ùå No | Search, Import (current) |
| `unit(id)` query | 75+ | ‚úÖ Yes | Preview (new), Fetch detailed script |

## üéØ Next Steps

1. **Option A**: Update import flow to use detailed data
   - Modify `handleImportDetails()` in `app/import/zerez/page.tsx`
   - Change to fetch detailed specs before saving

2. **Option B**: Update `zerez_json_importer.py`
   - Replace `unitOverview` query with `unit(id)` query
   - Ensure all import scripts use detailed data

3. **Option C**: Make it configurable
   - Add checkbox: "Include detailed technical specifications"
   - Let users choose basic vs detailed import

## üß™ Testing Checklist

- [x] Preview displays all 50+ columns
- [x] German technical specs visible in preview
- [x] User warning if detailed fetch fails
- [x] Table handles 50+ columns without performance issues
- [ ] Import saves detailed specs (NOT YET IMPLEMENTED)
- [ ] Imported JSON files contain German tech specs (NOT YET IMPLEMENTED)
