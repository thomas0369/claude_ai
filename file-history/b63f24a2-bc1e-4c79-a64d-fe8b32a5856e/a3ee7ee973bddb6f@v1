/**
 * Centralized unit formatting utilities
 *
 * Ensures consistent precision and unit display across the application.
 * All formatters handle null/undefined gracefully by returning 'N/A'.
 */

export const UnitFormatters = {
  /**
   * Format power values in kilowatts
   * @param kw - Power in kilowatts
   * @param precision - Decimal places (default: 1)
   * @returns Formatted string with unit (e.g., "100.5 kW") or "N/A"
   *
   * @example
   * UnitFormatters.power(100.567) // "100.6 kW"
   * UnitFormatters.power(0) // "0.0 kW"
   * UnitFormatters.power(null) // "N/A"
   */
  power(kw: number | null | undefined, precision: number = 1): string {
    if (kw == null) return 'N/A';
    return `${kw.toFixed(precision)} kW`;
  },

  /**
   * Format voltage values
   * @param volts - Voltage in volts
   * @param precision - Decimal places (default: 0 for whole numbers)
   * @returns Formatted string with unit (e.g., "400 V") or "N/A"
   *
   * @example
   * UnitFormatters.voltage(400.7) // "401 V"
   * UnitFormatters.voltage(230.5) // "231 V"
   * UnitFormatters.voltage(null) // "N/A"
   */
  voltage(volts: number | null | undefined, precision: number = 0): string {
    if (volts == null) return 'N/A';
    return `${volts.toFixed(precision)} V`;
  },

  /**
   * Format current values in amperes
   * @param amps - Current in amperes
   * @param precision - Decimal places (default: 1)
   * @returns Formatted string with unit (e.g., "16.5 A") or "N/A"
   */
  current(amps: number | null | undefined, precision: number = 1): string {
    if (amps == null) return 'N/A';
    return `${amps.toFixed(precision)} A`;
  },

  /**
   * Format percentage values
   * @param percent - Percentage value (0-100)
   * @param precision - Decimal places (default: 1)
   * @returns Formatted string with % symbol (e.g., "95.5%") or "N/A"
   */
  percent(percent: number | null | undefined, precision: number = 1): string {
    if (percent == null) return 'N/A';
    return `${percent.toFixed(precision)}%`;
  },

  /**
   * Generic number formatter with null handling
   * @param value - Numeric value
   * @param precision - Decimal places (default: 0)
   * @returns Formatted string or "N/A"
   */
  number(value: number | null | undefined, precision: number = 0): string {
    if (value == null) return 'N/A';
    return value.toFixed(precision);
  },

  /**
   * Format string values with fallback
   * @param value - String value
   * @param fallback - Fallback text (default: "N/A")
   * @returns Original string or fallback
   */
  string(value: string | null | undefined, fallback: string = 'N/A'): string {
    return value && value.trim() !== '' ? value : fallback;
  },
};
